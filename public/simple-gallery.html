<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æç®€å›¾åº“ - è°ƒè¯•æ¨¡å¼</title>
    <style>
        body { font-family: sans-serif; padding: 20px; background: #f0f0f0; }
        h1 { text-align: center; }
        #status { text-align: center; margin-bottom: 20px; color: #666; }
        .grid { display: flex; flex-wrap: wrap; gap: 10px; justify-content: center; }
        .card { background: white; padding: 10px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); width: 200px; }
        .card img { width: 100%; height: 200px; object-fit: cover; border-radius: 4px; background: #eee; }
        .card .info { font-size: 12px; margin-top: 5px; color: #333; word-break: break-all; }
        .error { color: red; font-weight: bold; }
    </style>
</head>
<body>
    <h1>ğŸŒ æç®€å›¾åº“ (è°ƒè¯•ç”¨)</h1>
    <div id="status">æ­£åœ¨åŠ è½½æ•°æ®...</div>
    <div id="grid" class="grid"></div>

    <script>
        const API_URL = '/api/images?page=1&pageSize=500'; // è·å–å‰500å¼ 

        async function loadImages() {
            const statusEl = document.getElementById('status');
            const gridEl = document.getElementById('grid');

            try {
                statusEl.textContent = 'æ­£åœ¨è¯·æ±‚ API...';
                const response = await fetch(API_URL);
                const result = await response.json();

                if (!result.success) {
                    statusEl.innerHTML = `<span class="error">API é”™è¯¯: ${result.message}</span>`;
                    return;
                }

                const images = result.data.images || [];
                statusEl.textContent = `è·å–æˆåŠŸ: å…± ${images.length} å¼ å›¾ç‰‡`;

                if (images.length === 0) {
                    gridEl.innerHTML = '<div>æš‚æ— å›¾ç‰‡</div>';
                    return;
                }

                gridEl.innerHTML = images.map(img => {
                    const url = img.thumbnailUrl || img.imageUrl;
                    const date = new Date(img.createdAt).toLocaleString();
                    return `
                        <div class="card">
                            <a href="${img.imageUrl}" target="_blank">
                                <img src="${url}" alt="åŠ è½½å¤±è´¥" onerror="this.src='data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>âŒ</text></svg>'">
                            </a>
                            <div class="info">
                                <div>ID: ${img.id.substring(0, 8)}...</div>
                                <div>è´¦æˆ·: ${img.accountEmail}</div>
                                <div>æ—¶é—´: ${date}</div>
                                <div>çŠ¶æ€: ${img.status}</div>
                            </div>
                        </div>
                    `;
                }).join('');

            } catch (e) {
                statusEl.innerHTML = `<span class="error">åŠ è½½å¤±è´¥: ${e.message}</span>`;
                console.error(e);
            }
        }

        loadImages();
    </script>
</body>
</html>